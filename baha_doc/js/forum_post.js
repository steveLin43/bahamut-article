(function(e,m){var p={post:function(){if(p.checkSubboard(),p.checkTitle(),!!e(".BH-menu__post__btn a").hasClass("is-active")){var t=e('input[name="ptype"]');if(e("#check-re:checked").length&&e("#check-mail:checked").length)t.val(2);else if(e("#check-re:checked").length)t.val(3);else if(e("#check-mail:checked").length)t.val(1);else{toastr.error("\u81F3\u5C11\u9700\u9078\u64C7\u4E00\u7A2E\u56DE\u8986\u65B9\u5F0F");return}var s=[];e(".post__template__item").each(function(){if(e(this).data("used")){var f=parseInt(e(this).data("ssn"),10);isNaN(f)||s.push(f)}});for(var d=e("#form1"),u=0;u<s.length;u++)d.append('<input type="hidden" name="usedSsn[]" value="'+s[u]+'">');p.setupThumbnail(),d.submit()}},preview:function(){var t=document.getElementById("frmPv");if(bahaRte.getContent().match(/\[img=http:\/\/[^\]]+\]/)){toastr.info("\u56E0\u61C9\u5B89\u5168\u6027\uFF0C\u5373\u65E5\u8D77\u53EA\u652F\u63F4 https \u7684\u5716\u7247\u3002");return}t.pv_title.value=e('[name="title"]').val(),t.pv_content.value=bahaRte.getContent(),t.pv_demonstratioType.value=e('[name="demonstratioType"]').val();var s=new Dialogify("#previewTemplate",{size:Dialogify.SIZE_LARGE});e(".dialogify .tab-menu").children("li").click(function(d){var u=e(this).index();e(".dialogify .tab-wrapper").children("div").hide().filter(":eq("+u+")").show(),e(this).addClass("active").siblings("li").removeClass("active");var f;u==1?(e('[name="pv_mobile"]').val("yes"),f="mobilePreview"):(args="",e('[name="pv_mobile"]').val(""),f="desktopPreview"),e('[name="'+f+'"]').data("posted")||(t.action="/post_preview_editor.php?"+new Date().getTime(),t.target=f,t.submit(),e('[name="'+f+'"]').data("posted","yes"))}),e(".dialogify .tab-menu li:eq(0)").click(),s.showModal()},bmPreview:function(t){var s=document.getElementById("frmPv");if(bahaRte.getContent().match(/\[img=http:\/\/[^\]]+\]/)){toastr.info("\u56E0\u61C9\u5B89\u5168\u6027\uFF0C\u5373\u65E5\u8D77\u53EA\u652F\u63F4 https \u7684\u5716\u7247\u3002");return}var d=new Dialogify("#bmPreviewTemplate",{size:Dialogify.SIZE_LARGE});s.rtecontent.value=bahaRte.getContent(),s.action="/gemadmin/bm_preview_editor.php",s.target="bmPreview";var u=0;switch(t){case"mannoce":u=938;break;case"guidance":u=760;break}e('.dialogify iframe[name="bmPreview"]').width(u),s.submit(),d.showModal()},cancel:function(t){t=typeof t<"u"?t:"post";var s="";switch(t){case"g2":case"bm":s="\u4F60\u78BA\u5B9A\u8981\u53D6\u6D88\u7DE8\u8F2F\u4E26\u522A\u9664\u5099\u4EFD\u6A94\u55CE\uFF1F";break;case"post":default:s="\u4F60\u78BA\u5B9A\u8981\u53D6\u6D88\u767C\u6587\u4E26\u522A\u9664\u5099\u4EFD\u6A94\u55CE\uFF1F"}Dialogify.confirm(s,{ok:function(){m.onbeforeunload=null,m.onunload=null,e.post("/editor/delAutosave.php",{service:"forum"},function(d){d=="DONE"?t=="g2"?m.close():m.history.back():Dialogify.alert("\u7CFB\u7D71\u5FD9\u788C\u4E2D\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66")})}})},backup:function(){bahaRte.utility.save()},legendPost:function(){Cookies.set("ckForumLegendPost","yes",{expires:365}),m.location="post1_legend.php"+location.search},bindTitleChecker:function(){e('input[name="title"]').on("focus",function(){e(this).removeClass("is-error")}).on("blur",function(){p.checkSubboard(),p.checkTitle()}).on("input",function(){var t=e(".c-post__header > h3").text()=="\u7DE8\u8F2F\u6587\u7AE0"?192:180;Forum.Common.utf8Length(e(this).val())>t?e(this).hasClass("is-error")||(e(this).addClass("is-error"),toastr.warning("\u4F60\u7684\u6A19\u984C\u5B57\u6578\u592A\u591A\u56C9\uFF01"),h(-i)):e(this).hasClass("is-error")&&(e(this).removeClass("is-error"),h(i))})},initAccordion:function(){e(".postset_item h5").css("cursor","pointer").click(function(d){e(this).next("ul").slideToggle(200),e(this).find("i").toggleClass("is-slideup");var u=e(this).parents(".postset_item").index()+1,f=e(this).find("i").hasClass("is-slideup");y(u,f)});var t=y();for(var s in t)t[s]===!0&&e(".postset_item:nth-child("+s.substring(1)+")").find("ul").hide().end().find("h5 i").addClass("is-slideup")},initSlick:function(){e("#thumbnail_preview").length!=0&&(e("#thumbnail_preview ul").slick({prevArrow:e("#thumbnail_preview .post-prev-btn"),nextArrow:e("#thumbnail_preview .post-next-btn")}),e("#use-thumb").is(":checked")||e("#thumbnail_preview .c-post__body").hide(),e("#use-thumb").change(function(t){e("#thumbnail_preview .c-post__body").toggle(),e("#use-thumb").is(":checked")&&e("#thumbnail_preview ul").trigger("resize")}))},setupThumbnail:function(){var t=e("#thumbnail_preview ul").slick("slickCurrentSlide"),s=e("#thumbnail_preview ul li:not(.slick-cloned):eq("+t+")");if(s.length!=0){var d=s.data("thumbnail").replace(/[-[\]{}()*+?.,\\/^$|#\s]/g,"\\$&");if(bahaRte.isPlainText){var u=new RegExp("(\\[(?:img|movie)="+d+")([^\\]]*?\\])"),f=bahaRte.source.value;f=f.replace(/(\[(?:img|movie)=[^\]]*?) thumbnail=yes([^\]]*?\])/g,"$1$2"),bahaRte.source.value=f.replace(u,"$1 thumbnail=yes$2")}else{var f=bahaRte.doc.body.innerHTML;f=f.replace(/(<img [^>]*?)data-thumbnail="yes"([^>]*?>)/g,"$1$2");var k,u;(k=s.data("thumbnail").match(/^https:\/\/i1\.ytimg\.com\/vi\/([0-9a-zA-Z_-]{11})\/hqdefault\.jpg$/))?u=new RegExp('(<img [^>]*?data-movie="https:\\/\\/www\\.youtube\\.com\\/watch\\?v='+k[1]+'")([^>]*?>)'):u=new RegExp('(<img [^>]*?src="'+d+'")([^>]*?>)'),bahaRte.doc.body.innerHTML=f.replace(u,'$1 data-thumbnail="yes"$2')}e("#thumbnail_preview:visible").length&&e('input[name="thumbnail"]').val(s.data("thumbnail"))}},checkTitle:function(){var t=e('input[type="text"][name="title"]');if(!t.length){h(i);return}var s=e(".c-post__header > h3").text()=="\u7DE8\u8F2F\u6587\u7AE0"?192:180;t.val()==""||Forum.Common.utf8Length(t.val())>s?(t.addClass("is-error"),h(-i)):h(i)},checkSubboard:function(){var t=e('select[name="nsubbsn"]');t.prop("selectedIndex")==0?(t.addClass("is-error"),h(-v)):(t.removeClass("is-error"),h(v))},tourPost:function(){var t=new Shepherd.Tour({defaults:{classes:"shepherd-theme-arrows",showCancelLink:!0}});t.on("start",function(){g()}),t.on("complete",function(){_()}),t.on("cancel",function(){_()}),t.addStep("step1",{text:'<img width="600" height="480" src="https://i2.bahamut.com.tw/forum/firstpost.jpg">',buttons:{text:"\u4E0B\u4E00\u500B",action:t.next}}),t.addStep("step2",{text:"\u52D5\u4F5C\u6309\u9215\u7F6E\u9802\uFF0C\u65B9\u4FBF\u4F60\u96A8\u6642\u5099\u4EFD\u3001\u9810\u89BD\u3001\u767C\u4F48\u6587\u7AE0\u3002",attachTo:{element:".BH-menu-forumA-right",on:"bottom"},title:"\u4E09\u5927\u529F\u80FD\u5E38\u99D0",buttons:{text:"\u4E0B\u4E00\u500B",action:t.next}}),t.addStep("step3",{text:"\u65B9\u4FBF\u4F60\u5728\u6587\u7AE0\u4E2D\u5D4C\u5165\u5716\u7247\u3001\u5F71\u7247\u548C\u8868\u60C5\u7B26\u865F\u3002",attachTo:{element:".side_gray_box.box-shadow__shallow:first-child",on:"bottom"},title:"\u5E38\u99D0\u63D2\u5165\u529F\u80FD",buttons:{text:"\u6211\u77E5\u9053\u4E86",action:t.next}}),t.start()},bindCCAnnounce:function(){var t=e("#check-cc");t.change(function(){t.is(":checked")?e(".cc-description").show():e(".cc-description").hide()}),t.is(":disabled")&&e('label[for="check-cc"] > h6 > a').attr("href","http://creativecommons.tw/explore").attr("target","_blank").html("\u4F5C\u8005\u6A19\u793A-\u975E\u5546\u696D\u6027")},bindCheckboxChange:function(){e('[name="ai"]').on("change",function(){let t=e('[name="donateApply"],[name="daren"]');this.checked?t.prop({checked:!1,disabled:!0}):t.prop("disabled",!1)}),e('[name="donateApply"],[name="daren"]').on("change",function(){let t=e('[name="ai"]');this.checked?t.prop({checked:!1,disabled:!0}):t.prop("disabled",!1)})},onSubjectChange:function(t){let s=t.options[t.selectedIndex].value;s=parseInt(s,10),[3,5,6,9].includes(s)?e("#check-master").prop("disabled",!1):(e("#check-master").prop("disabled",!0),e("#check-master").prop("checked",!1));let d=jQuery('input[type="text"][name="title"]'),u=e("#prevSubject");if(s==9)d.val("\u3010\u3011"+d.val());else if(u.val()==9){let f=d.val();f=f.replace(/^��.*?��/,""),d.val(f)}u.val(s),!(m.localStorage.getItem(n)=="yes"||e("#check-donate").prop("checked")||!e(".check-group-donate").length||![2,4].includes(t.selectedIndex))&&new Dialogify('<p>\u672A\u958B\u555F\u300C<span style="color:#f03434;font-weight:bold;">\u958B\u653E\u8D0A\u52A9</span>\u300D\uFF0C\u662F\u5426\u8981\u958B\u555F\uFF0C</p><p>\u4F86\u7372\u5F97\u73FE\u91D1\u56DE\u994B\u5462\uFF1F</p>').buttons(['<label for="ignoreNotice"><input type="checkbox" id="ignoreNotice" onchange="Forum.Post.onDonateIgnoreNoticeChange(this);"> \u4E0D\u518D\u63D0\u9192\u6211</label>',{text:"\u7565\u904E",click:function(f){this.close()}},{text:"\u958B\u555F\u8D0A\u52A9",type:Dialogify.BUTTON_PRIMARY,click:function(f){e("#check-donate").prop("checked",!0)}}]).showModal()},onDonateIgnoreNoticeChange:function(t){t.checked?m.localStorage.setItem(n,"yes"):m.localStorage.removeItem(n)},generateVoteInputFromVoteDetail:function(t){nunjucks.configure();let s=nunjucks.render("vote_input.njk.html",t);e("#form1").append(s),e("#frmPv").append(s);let d=nunjucks.render("vote_preview.njk.html",t);e(".main_editor_section > .c-post__body").append(d),t.is_end==0&&t.editAble==0&&c(parseInt(t.countDownTimestamp,0))},createOrEditVote:function(){nunjucks.configure();let t=x(),s=nunjucks.render("vote_dialog.njk.html",t),d=new Dialogify(s,{useDialogForm:!1,closable:!1}).buttons([{text:Dialogify.LOCALE.zh_TW.cancel,click:function(){this.close()}},{text:Dialogify.LOCALE.zh_TW.ok,type:Dialogify.BUTTON_PRIMARY,click:function(){R(this)&&(w(this),this.close())}}]).on("close",()=>{e("#dialogify_mask_style").remove(),e("#dialogify_mask").remove()}).title(t.default?"\u5EFA\u7ACB\u6295\u7968":"\u7DE8\u8F2F\u6295\u7968"),u=d.$content.find('input[name="title"]');u.keyup(function(){let S=e(this);S.prev("small").text(S.val().length+"/50\u5B57")}),u.prev("small").text(u.val().length+"/50\u5B57"),d.$content.find('input[name="options[]"]').each(function(){l(d,e(this).parent())});let f=d.$content.find(".editor__vote").get(0);new Sortable(f,{animation:150,handle:".handle-img",draggable:".vote-item"}),d.$content.find(".add-vote a").click(()=>{let S=d.$content.find('input[name="options[]"]').last().parent();o(d,S)}),d.$content.find('input[name="etime"]').datepicker({dateFormat:"yy-mm-dd",minDate:0,maxDate:31});let C=e("<div></div>");C.attr("id","dialogify_mask").css({position:"fixed",top:"0px",left:"0px",zIndex:100,backgroundColor:"black",width:"100%",height:"100%",opacity:.7}),e("body").append(C),e('<style id="dialogify_mask_style">.dialogify.fixed {z-index: 101 !important;}</style>').appendTo("head"),d.show()},deleteVote:function(){Dialogify.confirm("\u6295\u7968\u522A\u9664\u5F8C\u7121\u6CD5\u5FA9\u539F\uFF0C\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F",{ok:()=>{a(),e("#form1").append('<input type="hidden" name="vote-delete" value="1">')}})}};function x(){let t=e("#form1"),s=t.find('input[name="vote-title"]');s=s.length==0?"":s.val();let d=t.find('input[name="vote-etime"]');d=d.length==0?"":d.val();let u=t.find('input[name="vote-choiceLimit"]');u=u.length==0?"1":u.val();let f=t.find('input[name="vote-anonymous"]');f=f.length==0?"1":f.val();let k=t.find('input[name="vote-live"]');k=k.length==0?"1":k.val();let T=t.find('input[name="vote-options[]"]'),C=[];return T.length>0?T.each(function(){C.push(e(this).val())}):(C.push(""),C.push("")),{default:t.find('input[name="vote-title"]').length==0,title:s,etime:d,choiceLimit:u,anonymous:f,live:k,options:C}}function w(t){a(),e("#createOrEditVote").find("h6").text("\u7DE8\u8F2F\u6295\u7968");let s=t.$content.find('input[name="title"]').val(),d=t.$content.find('input[name="etime"]').val(),u=t.$content.find("#choiceLimit option:selected").val(),f=t.$content.find("input[name=anonymous]:checked").val(),k=t.$content.find("input[name=live]:checked").val(),T=[];t.$content.find('input[name="options[]"]').each(function(){T.push(e(this).val())}),p.generateVoteInputFromVoteDetail({editAble:1,is_end:0,title:s,etime:d,choiceLimit:u,anonymous:f,live:k,options:T})}function R(t){let s=t.$content.find("#errorMessage"),d=t.$content.find('input[name="title"]');if(d.removeClass("is-error"),d.val().length==0||d.val().length>50)return s.text("\u6A19\u984C\u7A7A\u767D\u6216\u592A\u9577\uFF0C\u8ACB\u4FEE\u6539\u5F8C\u518D\u767C\u4F48"),d.addClass("is-error"),d.focus(),!1;let u=t.$content.find('input[name="etime"]');if(u.removeClass("is-error"),u.val().length!=10)return s.text("\u6295\u7968\u7D50\u675F\u65E5\u7A7A\u767D\u6216\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u4FEE\u6539\u5F8C\u518D\u767C\u4F48"),u.addClass("is-error"),u.focus(),!1;let f=t.$content.find("#choiceLimit option:selected"),k=[];if(t.$content.find('input[name="options[]"]').each(function(){e(this).removeClass("is-error"),k.push(e(this))}),f.parent().removeClass("is-error"),f.val()>k.length)return s.text("\u591A\u9078\u6578\u91CF\u5927\u65BC\u9078\u9805\u6578\u91CF\uFF0C\u8ACB\u91CD\u65B0\u78BA\u8A8D\u3002"),f.parent().addClass("is-error"),f.focus(),!1;if(k.length>20)return s.text("\u6295\u7968\u9078\u9805\u904E\u591A(\u6700\u591A 20 \u9805)"),!1;for(let T=0;T<k.length;T++){let C=k[T];if(C.val().length==0||C.val().length>50)return s.text("\u9078\u9805\u7A7A\u767D\u6216\u592A\u9577\uFF0C\u8ACB\u4FEE\u6539\u5F8C\u518D\u767C\u4F48 (\u6700\u591A 50 \u5B57)"),C.addClass("is-error"),C.focus(),!1}return!0}function a(){e('#form1 input[name|="vote"]').remove(),e('#frmPv input[name|="vote"]').remove(),e(".main_editor_section > .c-post__body .vote-block").remove(),e("#createOrEditVote").find("h6").text("\u5275\u5EFA\u6295\u7968")}function o(t,s){if(t.$content.find('input[name="options[]"]').length>=20){t.$content.find("#errorMessage").text("\u6295\u7968\u9078\u9805\u6700\u591A 20 \u9805");return}let d=nunjucks.render("vote_option.njk.html",{options:""}),u=e(d);l(t,u),s.after(u),u.find("input").focus()}function l(t,s){let d=!1;s.find("a").click(function(){let u=e(this);b(t,u.parent())}),s.find("input").on("compositionstart",()=>{d=!0}).on("compositionend",()=>{d=!1}).keydown(function(u){switch(u.which||u.keyCode){case 8:let f=e(this);f.val().length==0&&(b(t,f.parent()),u.preventDefault());break;case 13:if(d)return;o(t,e(this).parent());break}})}function c(t){let s=t,d=s%60;d<10&&(d="0"+d),s=Math.floor(s/60);let u=s%60;u<10&&(u="0"+u),s=Math.floor(s/60);let f=s%24;f<10&&(f="0"+f);let k=Math.floor(s/24);k<10&&(k="0"+k),e("#countDown").text(`${k}\u5929 ${f}:${u}:${d}`),t=t-1,!(t<0)&&setTimeout(c,1e3,t)}function b(t,s){t.$content.find('input[name="options[]"]').length>2&&(s.prev().find("input").focus(),s.remove())}const v=1,i=2,n="DONATE_ignore_notice";var r;function h(t){t<0?(t=Math.abs(t),r&t&&(r-=t)):r|=t;var s=e(".BH-menu__post__btn a");r==v+i?s.addClass("is-active"):s.removeClass("is-active")}function g(){e("<div />").addClass("tour-overlay").attr("id","tourOverlay").appendTo("body")}function _(){e("#tourOverlay").remove()}function y(t,s){const d="FORUM_POST_accordion";var u=m.localStorage.getItem(d);if(u?u=JSON.parse(u):u={},t!==void 0&&s!==void 0)u["a"+t]=s,m.localStorage.setItem(d,JSON.stringify(u));else return u}m.Forum=m.Forum||{},m.Forum.Post=p})(jQuery,window),function(e,m){var p={dialogInst:null,savedSelection:null,initEmoticonPanel:function(){var a=e("#fe_emoticon .postaddemoji-list"),o=[11,12,10,10],l=1;for(var c in o){var b=e("<div />").addClass("emoji-list__box");a.append(b);for(var v=0;v<o[c];v++){var i=e("<a />").attr("href","javascript:;").on("mousedown",bahaRte.toolbar.insertEmotion),n=e("<img />").addClass("lazyload").attr("data-src","https://i2.bahamut.com.tw/editor/emotion/"+(v+l)+".gif").appendTo(i);b.append(i)}l+=o[c]}},emoticonPanel:function(a,o){bahaRte.win.focus(),a.preventDefault(),a.stopPropagation(),jQuery("#fe_balloon_toolbar:visible").fadeOut(200);var l=e(o).offset();e("#fe_emoticon").css({top:l.top-40,left:l.left-e("#BH-wrapper").offset().left+25}).off("mousedown").on("mousedown",function(c){c.preventDefault(),c.stopPropagation()}).slideToggle(200),e("body").on("mousedown",function(c){p.hidePanel(),c.preventDefault(),c.stopPropagation()})},colorPanel:function(a,o){bahaRte.win.focus(),a.preventDefault(),a.stopPropagation();var l=e("#fe_color_picker").data("id"),c=e(o).prev("button").data("id");if(l!==void 0){if(p.hidePanel(),l==c)return;e("#fe_color_picker").hide()}var b=e("#fe_color_picker").parent().offset(),v=e(o).offset();e("#fe_color_picker").css({left:v.left-b.left,top:v.top-b.top+36}).off("mousedown").on("mousedown",function(i){i.preventDefault(),i.stopPropagation()}).data("id",c).slideDown(200).find('span[role="button"]').off("mousedown").on("mousedown",function(i){i.preventDefault()}).off("mouseup").on("mouseup",function(i){i.preventDefault(),p.hidePanel();var n=e(this).data("value");c=="_bhrte_forecolor"?bahaRte.toolbar.setForeColor(n):bahaRte.toolbar.setBackgroundColor(n)}),e(o).addClass("is-active"),e("body").on("mousedown",function(i){p.hidePanel(),i.preventDefault(),i.stopPropagation()})},hidePanel:function(){e(".fe_panel:visible").slideUp(200),e("#fe_color_picker").removeData("id"),e(".editor-button.editor-button__s.is-active").removeClass("is-active"),e("body").off("mousedown")},initDropdownList:function(){e(".js-link").mousedown(function(a){bahaRte.win.focus(),Forum.Editor.hidePanel();var o=e(this).next(".js-dropdown-list"),l=e(".js-dropdown-list:visible");l.length&&l.prev(".js-link").data("id")!=e(this).data("id")&&l.slideUp(200),o.is(":hidden")&&e("body").on("mousedown",function(c){e("body").off("mousedown"),o.slideUp(200),c.preventDefault(),c.stopPropagation()}),o.slideToggle(200),a.preventDefault(),a.stopPropagation()}).next(".js-dropdown-list").find("li").on("mousedown",function(a){a.preventDefault(),a.stopPropagation()}).on("mouseup",function(a){bahaRte.win.focus();var o=e(this).parent(".js-dropdown-list"),l=o.prev("a.js-link").data("id");switch(l){case"fe_header":e(this).data("value")=="quote"?bahaRte.toolbar.toggleQuote():bahaRte.toolbar.insertHeading(this);break;case"fe_fontsize":bahaRte.toolbar.setSize(this);break;case"fe_font":bahaRte.toolbar.setFont(this);break;default:}e('[data-id="'+l+'"] span').text(e(this).text()),o.slideToggle(200),a.preventDefault(),a.stopPropagation()}),e(".editor-button__viewmore").mousedown(function(a){var o=e(this).next(".editor-toolbar__outerbox");if(o.hasClass("is-hidden")){e(".editor-toolbar__outerbox").addClass("is-hidden");var l=e(m).width(),c=o.width(),b=-(c/2-e(this).width()/2-4);o.removeClass("is-hidden").css("left",b);var v=o.offset();v.left<0?b-=v.left:v.left+c>l&&(b-=v.left+c-l),o.css("left",b)}else o.addClass("is-hidden");a.preventDefault(),a.stopPropagation()})},bindToolbarClick:function(){e(".editor-button:not(.editor-button__s,.editor-button__viewmore,.dropdown-group,.fe_source)").mousedown(function(a){bahaRte.toolbar.buttonClick(a,this)}),e(".editor-button__s").mousedown(function(a){Forum.Editor.colorPanel(a,this)}),e(".fe_source").mousedown(function(a){bahaRte.toolbar.alternateView(!0),a.preventDefault(),a.stopPropagation()})},onPaste:function(a,o){var l=/https?:\/\/[^\s]+/g,c=/trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,b=o.match(l);if(!(!b||b.length==0)){var v=o;b.forEach(function(i){var n=v.split(i),r=n.shift();navigator.userAgent.toLowerCase().match(c)?bahaRte.utility.insertHtml(r.replace(/\r\n/g,"<br>").replace(/\n/g,"<br>").replace(/\r/g,"<br>")):bahaRte.doc.execCommand("inserttext",!1,r.replace(/\r\n/g,`
`).replace(/\r/g,`
`));var h=i.match(/\.(?:png|jpe?g|gif|webp)$/i),g=w(i);if(!h&&!g){i=x(i);var _='<a href="'+i+'">'+i+"</a>";bahaRte.utility.insertHtml(_)}else if(g)bahaRte.toolbar.insertMovie(null,g);else{var y=i;if(y.match(/^https:\/\//)||(y=Util.HttpImgFilter.forceToHttps(y)),y)bahaRte.toolbar.insertImage(null,y);else{i=x(i);var _='<a href="'+i+'">'+i+"</a>";bahaRte.utility.insertHtml(_)}}v=n.join(i)}),navigator.userAgent.toLowerCase().match(c)?bahaRte.utility.insertHtml(v.replace(/\r\n/g,"<br>").replace(/\n/g,"<br>").replace(/\r/g,"<br>")):bahaRte.doc.execCommand("inserttext",!1,v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),Forum.Editor.detectThumbnail(),a.preventDefault()}},onSignChange:function(a,o){var l=e(".postset_signature");if(a==0)l.slideUp(200);else{o=o.toLowerCase();var c="https://gc.bahamut.com.tw/sign/html/";c+=o.charAt(0)+"/"+o.charAt(1)+"/"+o+"_"+a+".html",l.find("iframe").attr("src",c),l.slideDown(200)}},detectThumbnail:function(a){var o=bahaRte.isPlainText?bahaRte.source.value:bahaRte.doc.body.innerHTML;if(o){var l,c=[],b=/https?:\/\/www\.youtube\.com\/watch\?v=([0-9a-zA-Z_-]{11})/g;for(l=b.exec(o);l;)c.push("https://i1.ytimg.com/vi/"+l[1]+"/hqdefault.jpg"),l=b.exec(o);if(l=o.match(/https?:\/\/[^>"]+?\/[^>"\s]+\.(?:jpe?g|png|webp)/gi))for(var v=0;v<l.length;v++){//!matches[i].match(/https?:\/\/i2\.bahamut\.com\.tw\/editor\/movie_pre\.gif/)
//!matches[i].match(/https?:\/\/(?:pic|i2)\.bahamut\.com\.tw\/(?:fckeditor|editor)\/(?:smiley|emotion)\/[0-9]+\.gif/)
l[v].match(/https?:\/\/ref\.gamer\.com\.tw/)||c.push(l[v])}var i=e("#thumbnail_preview ul");if(i.length!=0)if(e("#thumbnail_preview ul li:not(.slick-cloned)").each(function(r,h){c.indexOf(e(h).data("thumbnail"))==-1&&i.slick("slickRemove",r)}),c.length){var n=function(){for(var r=0;r<c.length;r++)if(i.find('li[data-thumbnail="'+c[r]+'"]:not(.slick-cloned)').length==0){var h=e("<li>").addClass("post_img-item").css("background-image","url("+c[r]+")").attr("data-thumbnail",c[r]);i.slick("slickAdd",h)}if(a){var g=R(),_=-1;g&&(e("#thumbnail_preview ul li:not(.slick-cloned)").each(function(y,t){e(t).data("thumbnail")==g&&(_=y)}),_>=0&&i.slick("slickGoTo",_,!0))}};e("#thumbnail_preview:visible").length?n():e("#thumbnail_preview:hidden").slideDown(200,n)}else e("#thumbnail_preview:visible").slideUp(200)}},showVideoDialog:function(){var a=new Dialogify("#insertVideoTemplate",{size:Dialogify.SIZE_LARGE,closable:!1});e("#_bhrte_movieCode").on("input",function(l){bahaRte.dialog.previewMovie()}),p.initInputBoxClearButton(),p.dialogInst=a,p.saveSelection();var o=bahaRte.selection.getSelectedImageInfo();a.title("\u5D4C\u5165\u5F71\u7247").buttons([{text:"\u53D6\u6D88",click:function(){this.close(),p.restoreSelection()}},{text:"\u63D2\u5165\u5F71\u7247",type:Dialogify.BUTTON_PRIMARY,click:bahaRte.toolbar.insertMovie,disabled:!0}]).on("show",function(){o.movie&&e("#_bhrte_movieCode").val(o.movie).trigger("input")}).showModal()},showTableDialog:function(){var a=new Dialogify("#insertTableTemplate",{closable:!1});if(p.dialogInst=a,a.title("\u65B0\u589E\u8868\u683C"),e("#_bhrte_tbborder, #_bhrte_tbalign").click(function(n){var r=e(this).next(".js-dropdown-list"),h=e(".js-dropdown-list:visible");h.length&&h.prev("a").attr("id")!=e(this).attr("id")&&h.slideUp(200),r.slideToggle(200),n.preventDefault(),n.stopPropagation()}).next(".js-dropdown-list").find("li").on("click",function(n){var r=e(this).parent(".js-dropdown-list"),h=r.prev("a").attr("id");e("#"+h).data("value",e(this).data("value")).find("span").text(e(this).text()),r.slideUp(200),n.preventDefault(),n.stopPropagation()}),!bahaRte.isPlainText){for(var o=bahaRte.selection.getSelectedNode();!o.nodeName.inArray(["table","body"],!0);)o=o.parentNode;if(o.nodeName.equals("table")){var l=parseInt(o.getAttribute("border"),10)||0,c=o.getAttribute("align")||0,b=o.style.height||o.getAttribute("height")||"",v=o.style.width||o.getAttribute("width")||"",i={0:0,left:1,center:2,right:3};e("#_bhrte_tbrow,#_bhrte_tbcol").prop("disabled",!0).val(""),e("#_bhrte_tbborder").next(".js-dropdown-list").find("li:eq("+l+")").click(),e("#_bhrte_tbalign").next(".js-dropdown-list").find("li:eq("+i[c]+")").click(),e("#_bhrte_tbcellpadding").val(parseInt(o.getAttribute("cellPadding"),10)||""),e("#_bhrte_tbcellspacing").val(parseInt(o.getAttribute("cellSpacing"),10)||""),e("#_bhrte_tbwidth").val(v.replace("px","").replace("%","")),e("#_bhrte_tbheight").val(b.replace("px","")),e("#_bhrte_tbIsModify").val("yes"),a.title("\u8A2D\u5B9A\u8868\u683C\u5C6C\u6027")}}p.saveSelection(),a.buttons([{text:"\u53D6\u6D88",click:function(){this.close(),p.restoreSelection()}},{text:"\u78BA\u5B9A",type:Dialogify.BUTTON_PRIMARY,click:bahaRte.toolbar.insertTable}]).showModal()},showTableCellDialog:function(){var a=new Dialogify("#editTableCellTemplate"),o=bahaRte.selection.getSelectedCells();if(o){o=o[0];var l=o.style.height||o.getAttribute("height")||"",c=o.style.width||o.getAttribute("width")||"";e("#_bhrte_cellwidth").val(c.replace("px","").replace("%","")),e("#_bhrte_cellheight").val(l.replace("px",""))}p.dialogInst=a,p.saveSelection(),a.title("\u8A2D\u5B9A\u5132\u5B58\u683C\u5BEC\u9AD8").buttons([{text:"\u53D6\u6D88",click:function(){this.close(),p.restoreSelection()}},{text:"\u78BA\u5B9A",type:Dialogify.BUTTON_PRIMARY,click:bahaRte.table.setCellAttr}]).showModal()},showLinkDialog:function(){var a=new Dialogify("#createLinkTemplate",{closable:!1}),o=bahaRte.selection,l=o.getSelectedAnchorInfo(),c=bahaRte.selection.getSelectedText();p.initInputBoxClearButton(),p.dialogInst=a,p.saveSelection(),a.title("\u5EFA\u7ACB\uFF0F\u522A\u9664\u9023\u7D50").buttons(['<div id="_bhrte_displayUnlink" class="float-left" style="display:none;"><a href="javascript:bahaRte.toolbar.removeLink();">\u79FB\u9664\u9023\u7D50</a></div>',{text:"\u53D6\u6D88",click:function(){this.close(),p.restoreSelection()}},{text:"\u78BA\u5B9A",type:Dialogify.BUTTON_PRIMARY,click:bahaRte.toolbar.createLink,disabled:!0}]).on("show",function(){l.isLink&&(e("#_bhrte_linkurl").val(l.url),a.$buttonList._bhrte_displayUnlink.show(),c=l.text),c&&(e("#_bhrte_linktext").parent(".input-box").hide(),c.match(/^https?:\/\/.+$/)&&!l.isLink&&e("#_bhrte_linkurl").val(c)),e("#_bhrte_linktext").val(c),e("#_bhrte_linkurl, #_bhrte_linktext").on("input",function(b){var v=p.dialogInst.$buttonList[2];e("#_bhrte_linkurl").val().match(/^https?:\/\/.+$/)?v.enable():v.disable()}).trigger("input")}).showModal()},showColorDialog:function(){var a=new Dialogify("#colorTemplate");p.dialogInst=a,p.saveSelection();var o=e(".editor-button.editor-button__s.is-active").prev("button").data("id")=="_bhrte_bgcolor";e("#_bhrte_isBg").val(o),e(".color-picker .ql-picker-item").click(function(l){var c=e(this).data("value");e("#_bhrte_selectedColor").css("backgroundColor",c),e("#_bhrte_selectedColorText").val(c),e(".color-picker .ql-picker-item.is-active").removeClass("is-active"),e(this).addClass("is-active"),p.dialogInst.$buttonList[2].enable()}),a.title("\u9078\u64C7\u984F\u8272").buttons(['<div class="picker-item__selected"><span id="_bhrte_selectedColor" class="picker-item__preview" style="background-color:transparent;"></span><input id="_bhrte_selectedColorText" class="picker-item__input" type="text" placeholder="#RRGGBB"><a class="post__text-small" href="javascript:Forum.Editor.clearSelectColor();">\u6E05\u9664</a></div>',{text:"\u53D6\u6D88",click:function(){this.close(),p.restoreSelection()}},{text:"\u78BA\u5B9A",type:Dialogify.BUTTON_PRIMARY,click:bahaRte.dialog.setColor,disabled:!0}]).on("show",function(){var l=bahaRte.utility.getTagStatus(!0),c=o?bahaRte.constants.tagState.BACKGROUNDCOLOR:bahaRte.constants.tagState.FORECOLOR,b=o?l.bgcolorList:l.colorList;l.state&c&&(e("#_bhrte_selectedColor").css("backgroundColor",b[0]),e("#_bhrte_selectedColorText").val(b[0])),e("#_bhrte_selectedColorText").on("input",function(){let v=e(this).val();/^#[0-9a-f]{6}$/i.test(v)?(e("#_bhrte_selectedColor").css("backgroundColor",v),p.dialogInst.$buttonList[2].enable()):p.dialogInst.$buttonList[2].disable()})}).showModal()},clearSelectColor:function(){e("#_bhrte_selectedColor").css("backgroundColor","transparent"),e("#_bhrte_selectedColorText").val(""),p.dialogInst.$buttonList[2].disable()},initInputBoxClearButton:function(){e(".input-box .clearall").click(function(a){e(this).removeClass("is-active").next("input").val("")}),e(".input-box input").on("input",function(a){e(this).val()?e(this).prev(".clearall").addClass("is-active"):e(this).prev(".clearall").removeClass("is-active")})},insertImage:function(){var a=bahaRte.isPlainText?"#source":"#editor",o={action:Bahamut.TruthImage.ACTION_FORUM_INSERT,bsn:+new URL(m.location.href).searchParams.get("bsn"),onInsert:function(c){Forum.Editor.detectThumbnail()}},l=new Bahamut.TruthImage(o);return l.setEditor(a),bahaRte.isPlainText&&l.contentCallback(function(c){return"[img="+c+"]"}),l.showDialog(),l},focusEditor:function(){bahaRte.isPlainText?bahaRte.source.focus():bahaRte.win.focus()},saveSelection:function(){if(p.focusEditor(),bahaRte.isPlainText)p.savedSelection={selectionStart:bahaRte.source.selectionStart,selectionEnd:bahaRte.source.selectionEnd};else{var a=bahaRte.win.getSelection();(!a||a.rangeCount==0)&&(savedSelection=null);var o=a.getRangeAt(0);o||(savedSelection=null),p.savedSelection={range:o}}},restoreSelection:function(){if(p.savedSelection){if(p.focusEditor(),bahaRte.isPlainText)p.savedSelection.selectionStart&&p.savedSelection.selectionEnd&&(bahaRte.source.selectionStart=p.savedSelection.selectionStart,bahaRte.source.selectionEnd=p.savedSelection.selectionEnd);else if(p.savedSelection.range){var a=bahaRte.win.getSelection();a&&(a.removeAllRanges(),a.addRange(p.savedSelection.range))}}}};function x(a){return a.replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("'","&#039;").replaceAll("<","&lt;").replaceAll(">","&gt;")}function w(a){var o=/^https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([0-9a-zA-Z_-]{11})(?:.*(?:&(?:t|time_continue)=(\d+)))?/,l=/^https?:\/\/youtu\.be\/([0-9a-zA-Z_-]{11})(?:.*(?:(?:&|\?)(?:t|time_continue)=(\d+)))?/,c=/^https?:\/\/(?:www\.)?youtube\.com\/(?:shorts|live)\/([0-9a-zA-Z_-]{11})/,b=/^https?:\/\/www\.twitch\.tv\/([a-zA-Z0-9_-]+)/,v=/^https?:\/\/www\.twitch\.tv\/videos\/([0-9]+)/,i=/^https?:\/\/vlog\.xuite\.net\/play\/([a-zA-Z0-9+\/=]+)/,n=/^https?:\/\/www\.nicovideo\.jp\/watch\/((?:sm|nm|ca|cd|ax|yo|nl|ig|na|cw|za|zb|zc|zd|ze|om|sk|yk|so|am|fz)[0-9]{1,14}|[0-9]{10})/,r=/^https:\/\/livehouse\.in\/channel\/(\w+)/,h=/^https?:\/\/www\.facebook\.com\/(\w+)\/videos\/(\d+)$/,g=/^https:\/\/(?:twitter|x)\.com\/(\w+)\/status\/(\d+)(?:\?.*?)?$/,_;if(_=a.match(o)||a.match(l)||a.match(c)){var y="https://www.youtube.com/watch?v="+_[1];return _[2]&&(y+="&t="+_[2]),y}else{if(_=a.match(v))return null;if(_=a.match(b)||a.match(i)||a.match(n)||a.match(r)||a.match(h)||a.match(g))return _[0]}return null}function R(){var a;if(bahaRte.isPlainText){var o=bahaRte.source.value,l=o.match(/\[(?:img|movie)=(\S+)[^\]]*? thumbnail=yes[^\]]*?\]/);l&&(a=l[1])}else{var o=bahaRte.doc.body.innerHTML,l=o.match(/<img [^>]*?data-thumbnail="yes"[^>]*?>/);if(l){var c=l[0].match(/<img [^>]*?data-movie="https:\/\/www\.youtube\.com\/watch\?v=([0-9a-zA-Z_-]{11})[^"]*?"[^>]*?>/);if(c)a="https://i1.ytimg.com/vi/"+c[1]+"/hqdefault.jpg";else{var b=l[0].match(/<img [^>]*?src="([^"]*?)"[^>]*?>/);b&&(a=b[1])}}}return a||null}m.Forum=m.Forum||{},m.Forum.Editor=p}(jQuery,window),function(e,m){var p={initSnippetList:function(){const i="FORUM_SNIPPET_list";var n=e(".post__template__box"),r=e(".post__template");n.on("click",function(){n.hasClass("horizon_box")?(r.css({visibility:"visible",opacity:1,height:"auto"}),n.removeClass("horizon_box").addClass("is-close"),m.localStorage.removeItem(i)):(r.css({display:"block",visibility:"hidden",opacity:0,height:"37px"}),n.addClass("horizon_box").removeClass("is-close"),m.localStorage.setItem(i,"hide"))}),tippy(".post_template_img",{content:'<div class="tippyTemplate"></div>',allowHTML:!0,arrow:!1,animation:"fade",offset:[0,5],placement:"left",theme:"light",onShow:h=>{var g=h.reference;let _=e(e(g).html());_.css("width","300px"),e(h.popper).find(".tippyTemplate").empty().append(_)}}),m.localStorage.getItem(i)=="hide"&&(r.css({display:"block",visibility:"hidden",opacity:0,height:"37px"}),n.addClass("horizon_box").removeClass("is-close"))},initTagList:function(){e(".taglist__button").click(function(i){e('[name="tags[]"]').length>=10||(e(this).hasClass("taglist__add")?b():v())}),e(".taglist__input").keypress(function(i){switch(i.which||i.keyCode){case 13:i.preventDefault(),w?e(this._tippy.popper).find(".tag-user.active").click():p.addTag();break;default:}}).keydown(function(i){switch(i.which||i.keyCode){case 38:case 40:if(w){i.preventDefault();var n=e(this._tippy.popper);c(n,(i.which||i.keyCode)==38?"-1":"+1")}break;case 27:w||v();break;default:}}).on("compositionstart",function(i){e(this).data("composing",!0)}).on("compositionend",function(i){e(this).removeData("composing")}).keyup(function(i){if(!e(this).data("composing")){var n=i.which||i.keyCode;n==38||n==40||a(this,n)}})},bindTitleChecker:function(){e('input[name="title"]').on("focus",function(){e(this).removeClass("is-error")}).on("blur",function(){p.checkTitle()}),e('input[name="title"]').on("input",function(){Forum.Common.utf8Length(e(this).val())>180?e(this).hasClass("is-error")||(e(this).addClass("is-error"),e(".BH-menu__post__btn a").removeClass("is-active"),toastr.warning("\u4F60\u7684\u7BC4\u672C\u6A19\u984C\u5B57\u6578\u592A\u591A\u56C9\uFF01")):e(this).hasClass("is-error")&&(e(this).removeClass("is-error"),e(".BH-menu__post__btn a").addClass("is-active"))}),e('input[name="postTitle"]').on("input",function(){Forum.Common.utf8Length(e(this).val())>180?e(this).hasClass("is-error")||(e(this).addClass("is-error"),toastr.warning("\u4F60\u7684\u6587\u7AE0\u6A19\u984C\u5B57\u6578\u592A\u591A\u56C9\uFF01")):e(this).hasClass("is-error")&&e(this).removeClass("is-error")})},checkTitle:function(){var i=e('input[name="title"]'),n=e(".BH-menu__post__btn a");i.val()==""||Forum.Common.utf8Length(i.val())>180?(i.addClass("is-error"),n.removeClass("is-active")):n.addClass("is-active")},post:function(){if(p.checkTitle(),!!e(".BH-menu__post__btn a").hasClass("is-active")){var i=document.formSnippet;if(i.title.value.length==0||Forum.Common.utf8Length(i.title.value)>180){toastr.error("\u6A19\u984C\u7A7A\u767D\u6216\u592A\u9577\uFF0C\u8ACB\u4FEE\u6539\u5F8C\u518D\u767C\u4F48"),i.title.focus();return}if(bahaRte.isEmpty()){toastr.error("\u8ACB\u586B\u5BEB\u5167\u5BB9"),bahaRte.isPlainText?e("#source").addClass("is-error"):e("#editor").addClass("is-error");return}if(bahaRte.getContent().match(/\[img=http:\/\/[^\]]+\]/)){toastr.error("\u56E0\u61C9\u5B89\u5168\u6027\uFF0C\u5373\u65E5\u8D77\u53EA\u652F\u63F4 https \u7684\u5716\u7247\u3002");return}Dialogify.confirm("\u78BA\u5B9A\u767C\u4F48\u7BC4\u672C\uFF1F",{ok:function(){bahaRte.post("formSnippet",!0)}})}},cancel:function(){Dialogify.confirm("\u4F60\u78BA\u5B9A\u8981\u53D6\u6D88\u767C\u4F48\u7BC4\u672C\u4E26\u522A\u9664\u5099\u4EFD\u6A94\u55CE\uFF1F",{ok:function(){m.onbeforeunload=null,m.onunload=null,e.post("/editor/delAutosave.php",{service:"forum"},function(i){if(i=="DONE"){var n=m.location,r=n.search.match(/\?bsn=([0-9]+)/);r&&(n.href="https://forum.gamer.com.tw/gemadmin/snippet_manage.php?bsn="+r[1])}else Dialogify.alert("\u7CFB\u7D71\u5FD9\u788C\u4E2D\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66")})}})},addTag:function(){var i=e(".taglist__input"),n=document.createElement("div");n.appendChild(document.createTextNode(i.val().trim()));var r=n.innerHTML;if(!r){v();return}r=r.replace('"',"&quot;");var h=!1;if(e('[name="tags[]"]').each(function(){r.toLowerCase()==this.value.toLowerCase()&&(h=!0)}),h){toastr.warning("\u5DF2\u6709\u76F8\u540C\u6A19\u7C64"),setTimeout(function(){i.focus()},1);return}var g="<li>";g+='<div onclick="Forum.Snippet.removeTag(this);" class="taglist__tag">',g+=r+"</div>",g+='<input type="hidden" name="tags[]" value="'+r+'">',g+=`</li>
`,i.parents("li").before(g),v(),e('[name="tags[]"]').length>=10&&e(".taglist__tools").hide()},removeTag:function(i){e(i).parent("li").remove(),e(".taglist__tools").show()},addTagTippy:function(i){e(".taglist__input").val(e(i).find("span").text()),p.addTag()},filter:function(i,n){var r=e(".post__template .js-link > span"),h=e(".post__template__item");if(e(".post__template .js-dropdown-list > li").removeClass("is-active"),e(i).addClass("is-active"),n==0){h.show(),r.text("\u7BC4\u672C\u61F6\u4EBA\u5305");return}r.text(e(i).text()),h.each(function(){var g=e(this).data("tags");g.indexOf(n)==-1?e(this).hide():e(this).show()})},deleteCheck:function(){if(e('[name="snippetDel[]"]:checked').length==0){toastr.error("\u8ACB\u9078\u64C7\u6B32\u522A\u9664\u7684\u7BC4\u672C");return}Dialogify.confirm("\u78BA\u5B9A\u522A\u9664\u9078\u64C7\u7684\u7BC4\u672C\uFF1F",{ok:function(){m.onbeforeunload=null,m.onunload=null,e("#formSnippetDel").submit()}})},insert:function(i,n){i.preventDefault(),Cookies.set("ckForumLastSnippet",n,{expires:365,domain:"gamer.com.tw"}),e('.post__template__item[data-ssn="'+n+'"]').data("used",!0);var r=snippetList[n];if(r.post_title){var h=e('input[type="text"][name="title"]');h.val()===""&&h.val(r.post_title)}if(parseInt(r.post_subbsn,10)!=0){var h=e('select[name="nsubbsn"] option[value="'+r.post_subbsn+'"]');h.length&&h.prop("selected",!0)}if(parseInt(r.post_subject,10)!=0){var h=e('select[name="subject"] option[value="'+r.post_subject+'"]');h.length&&h.prop("selected",!0)}bahaRte.isPlainText?(bahaRte.source.focus(),bahaRte.utility.insertTextTag(r.content)):(bahaRte.win.focus(),bahaRte.utility.insertHtml(r.content_html))},toastrInfo:function(i){toastr.info(i)},supplyDialog:function(i){var n='<div class="post_template_modal">';n+='<div class="tab-box">',n+='<div class="absolutely-center">',n+='<div class="text-box">',n+="<p>\u76F8\u540C\u683C\u5F0F\u7684\u5167\u5BB9\uFF0C\u7E3D\u8981\u4E00\u76F4\u8907\u88FD\u8CBC\u4E0A\uFF0C\u4E0D\u5ACC\u9EBB\u7169\u55CE\uFF1F<br/>\u5FEB\u4F86<span>\u63D0\u4F9B\u7BC4\u672C\u7D66\u677F\u52D9\u5927\u5927</span>\u5011\u5427\uFF01</p>",n+="<h5>\u4E00\u65E6\u65B0\u589E\u6210\u529F\uFF0C<br/>\u672A\u4F86\u5728\u96FB\u8166\u7248\u6216APP\u4E0A\u767C\u6587\uFF0C\u90FD\u80FD\u4F7F\u7528<br/>\u65B9\u4FBF\u81EA\u5DF1\uFF0C\u4E5F\u65B9\u4FBF\u540C\u8DEF\u52C7\u8005\uFF0C<br/>\u8B93\u767C\u6587\u66F4\u52A0\u66A2\u884C\u7121\u963B\uFF01</h5>",n+="</div>",n+='<img src="https://i2.bahamut.com.tw/forum/post_template_img.png">',n+="</div></div></div>";var r='<div class="check-group text-left">';r+='<div class="post_template_info">',r+='<img src="https://i2.bahamut.com.tw/forum/icons/pixel-Q.svg">',r+='<h6>\u5982\u4F55\u63D0\u4F9B\u554A\uFF1F\u4F86\u9019\u5152<a href="https://forum.gamer.com.tw/C.php?bsn=60111&snA=113667" target="_blank">\u53C3\u8003\u7BC4\u672C</a></h6>',r+="</div></div>",new Dialogify(n,{size:Dialogify.SIZE_LARGE}).title("\u63D0\u4F9B\u61F6\u4EBA\u7BC4\u672C\u8B93\u767C\u6587\u66F4\u6548\u7387").buttons([r,{text:"\u53D6\u6D88",click:function(h){this.close()}},{text:"\u806F\u7D61\u677F\u52D9\u4EBA\u54E1",type:Dialogify.BUTTON_PRIMARY,click:function(h){var g;i?g="https://mailbox.gamer.com.tw/send.php?to="+i:g="https://forum.gamer.com.tw/B.php?bsn=60404",m.open(g)}}]).showModal()}},x=null,w=!1,R={content:'<div class="tag-list"><img src="https://i2.bahamut.com.tw/mobile/loading.svg"></div>',allowHTML:!0,placement:"bottom",trigger:"manual",interactive:!0,theme:"light",zIndex:2,sticky:!0,onShow:i=>{w=!0;var n=i.reference;l(n)},onShown:i=>{var n=i.reference;n.focus()},onHidden:i=>{w=!1}};function a(i,n){if(!i.value||w){w&&(n==27||[8,33,34,35,36,37,39].indexOf(n)!=-1&&!i.value?x.hide():[16,17,18].indexOf(n)==-1&&l(i));return}var r=e(i).position().left;R.offset=[0,r],R.appendTo=m.document.body,x=tippy(i,R),x.show()}function o(i){return`
<li>
    <a class="tag-user" href="javascript:;" onclick="Forum.Snippet.addTagTippy(this);">
        <span class="username">${i}</span>
    </a>
</li>`}function l(i){if(w){var n=document.createElement("div");n.appendChild(document.createTextNode(i.value.trim().toLowerCase()));var r=n.innerHTML;if(!r){x.hide();return}for(var h="",g=0;g<tagList.length;g++){var _=tagList[g];_.tag.toLowerCase().indexOf(r)!=-1&&(h+=o(_.tag))}h&&(h="<h3>\u73FE\u6709\u6A19\u7C64</h3><ul>"+h+"</ul>"),h+="<h3>\u65B0\u589E\u6A19\u7C64</h3><ul>"+o(r)+"</ul>";var y=e(i._tippy.popper);y.find(".tag-list").html(h);var t=y.find(".tag-user");t.mouseenter(function(s){t.removeClass("active"),e(this).addClass("active")}),setTimeout(function(){c(y,0)},1)}}function c(i,n){var r=i.find(".tag-user"),h=r.filter(".active"),g,_;if(r.length!=0){if(typeof n=="string"){var y=parseInt(n,10);_=r.index(h)+y,_>=r.length?_=0:_<0&&(_=r.length-1)}else _=n;g=r.filter(":eq("+_+")"),h.removeClass("active"),g.addClass("active");var t=i.find(".tag-list"),s=g.position().top+t.scrollTop()-150+16;t.stop().animate({scrollTop:s},200)}}function b(){e(".taglist__button").addClass("cancel").removeClass("taglist__add"),e(".taglist__input").addClass("is-active").focus(),e(".taglist").addClass("edit")}function v(){e(".taglist__button").removeClass("cancel").addClass("taglist__add"),e(".taglist__input").val("").removeClass("is-active"),e(".taglist").removeClass("edit"),x&&x.hide()}m.Forum=m.Forum||{},m.Forum.Snippet=p}(jQuery,window);