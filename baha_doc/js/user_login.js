(function(i,a,n,s){"use strict";var g={requireLogin:function(e,t){return t=t||"\u60A8\u5FC5\u9808\u5148\u767B\u5165\u624D\u80FD\u9032\u884C\u52D5\u4F5C",this.isLogin()?!0:(n.confirm(t,{ok:function(){var r=i.location;e=e||"https://"+r.host+r.pathname+r.search,a.set("ckFrom",e,{path:"/",domain:".gamer.com.tw"}),location.href="https://user.gamer.com.tw/login.php"}}),!1)},requireLoginIframe:function(e,t){return t=t||"\u8ACB\u5148\u767B\u5165",e=e||function(){location.reload()},this.isLogin()?!0:(i.addEventListener("message",function(r){if(new RegExp("^bodyHeight").test(r.data)){let o=r.data.split(",");jQuery("dialog").find("iframe").css("height",parseInt(o[1]))}switch(r.data){case"LoginFinish":e();break;case"LoginCancel":n.closeAll();break}},!1),new n('<iframe style="min-width: 360px; min-height: 450px; border: 0;" src="https://user.gamer.com.tw/login.php"></iframe>').title(t).showModal(),!1)},isLogin:function(){return this.getUserid()!==""},getUserid:function(){var e=(a.get("BAHAID")||"").trim();return e.match(/^[a-z][a-z0-9]{1,11}$/i)?e==="guest"?"":e:""},getAvatarUrl:function(e,t){if(e=e||!1,t||(t=this.getUserid()),t==="")return e?"":"https://i2.bahamut.com.tw/none.gif";t=t.toLowerCase();var r=parseInt(a.get("avtrv"),10);return r||(r=new Date().getTime(),a.set("avtrv",r.toString(),{expires:30,domain:"gamer.com.tw"})),"https://avatar2.bahamut.com.tw/avataruserpic/"+t.substr(0,1)+"/"+t.substr(1,1)+"/"+t+"/"+t+(e?"":"_s")+".png?v="+r},getUser:function(){return this.isLogin()?{isLogin:!0,userid:this.getUserid(),avatarLv:parseInt(a.get("BAHALV")||0,10),registerTime:new Date((a.get("BAHAFLT")||0)*1e3),avatarUrl:{small:this.getAvatarUrl(),big:this.getAvatarUrl(!0)},nickname:a.get("BAHANICK")!==s?Util.Html.decode(a.get("BAHANICK")):this.getUserid().toUpperCase()}:{isLogin:!1,userid:"",avatarLv:0,registerTime:new Date(0),avatarUrl:{small:this.getAvatarUrl(),big:this.getAvatarUrl(!0)},nickname:""}}};i.User=i.User||{},i.User.Login=g})(window,Cookies,Dialogify);